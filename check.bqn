# TODO debug using graphs
âŸ¨RangeâŸ© â† â€¢MakeRand 10

# limits
ex_lim â† 1000 â‹„ sk_lim â† 1000

# random number ranges
g0r â† 1000 â‹„ g1r â† 1000 â‹„ s0r â† 100

_check_ â† { 
  nameâ†ğ•© â‹„ Fâ†ğ”½ â‹„ Gâ†ğ”¾ 

  # increase smallest element
  G0 â† { ğ•Š âŸ¨âŸ© : âŸ¨Range g0râŸ©; ğ•Š ğ•© : { ğ•©+1âŒˆRange g0r}âŒ¾((âŠ‘â‹ğ•©)âŠ¸âŠ‘) ğ•© } 

  # add new element
  G1 â† { ğ•©âˆ¾Range g1r }   

  # reduce largest element
  S0 â† { ğ•Š âŸ¨âŸ© : âŸ¨âŸ©; ğ•Š ğ•© : {0âŒˆ(ğ•©-(Range s0r))}âŒ¾((âŠ‘â’ğ•©)âŠ¸âŠ‘) ğ•© } 

  # remove random element
  S1 â† { nâ†â†•â‰ ğ•© â‹„ /âŸœğ•©Â¬(Range â‰ ğ•©)=n }

  Grow â† { ğ•Š: 
    câ†0 â‹„ interestingâ†0
    b â† {
      c+â†©1 â‹„ b â† (Rangeâˆ˜â‰ âŠ¸âŠ‘0â€¿0â€¿0â€¿0â€¿1) â—¶ G0â€¿G1 ğ•© 
      {Â¬F G ğ•©}â—¶âŸ¨{ğ•©}, {ğ•Š: interestingâ†©1 â‹„ ğ•©}âŸ© b
    } â€¢_while_ { ğ•Š: (c<1000)âˆ§(Â¬interesting) } âŸ¨âŸ©
    interestingâ€¿b
  }

  Shrink â† {
    sameâ†0 â‹„ pâ†ğ•© â‹„ câ†0 â‹„ interestingâ†0
    bâ†{ ğ•Š:
      c+â†©1 â‹„ bâ†(Rangeâˆ˜â‰ âŠ¸âŠ‘0â€¿0â€¿0â€¿0â€¿1)â—¶ S0â€¿S1 ğ•© 
      {ğ•©â‰¡p}â—¶âŸ¨{ğ•Š:sameâ†©0}, {ğ•Š:same+â†©1}âŸ© b
      {Â¬F G ğ•©}â—¶âŸ¨p, {ğ•Š:pâ†©ğ•© â‹„ interestingâ†©1 â‹„ ğ•©}âŸ© b
    } â€¢_while_ { ğ•Š: (c<sk_lim) âˆ§ (same<10) } ğ•©
    p
  }

  OK â† { ğ•Š: â€¢Out "âœ“ " âˆ¾ name }

  Fail â† { ğ•Š: 
    â€¢Out "Ã— " âˆ¾ name 
    â€¢Out "  Counter: " âˆ¾ (â€¢Fmt G (Shrink ğ•©))
  }

  interestingâ€¿b â† Grow @
  interesting â—¶ OKâ€¿Fail b
}

#F â† { â€¢Show ğ•©â‹„nâ€¿(âŒŠnÃ·Ëœâ‰ ğ•©)â¥Š|ğ•© }
F â† { ğ•© }
â€¢Out "--"

#{ âˆ§Â´100>+Ë ğ•© } _check_ F "should show x"
{ âˆ§Â´100>ğ•© } _check_ F "should show x"
â€¢Out "done"
